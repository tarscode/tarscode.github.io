<!doctype html>



  


<html class="theme-next mist use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css"/>




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  




<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.0.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="算法," />





  <link rel="alternate" href="/atom.xml" title="TarsCode" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.0.1" />






<meta name="description" content="本篇文章是在实验室算法分享讲座时的内容">
<meta name="keywords" content="算法">
<meta property="og:type" content="article">
<meta property="og:title" content="最佳交易股票时间系列问题（Best Time to Buy and Sell Stock）">
<meta property="og:url" content="http://yoursite.com/2017/01/15/最佳交易股票时间问题/index.html">
<meta property="og:site_name" content="TarsCode">
<meta property="og:description" content="本篇文章是在实验室算法分享讲座时的内容">
<meta property="og:locale" content="zh-Hans">
<meta property="og:updated_time" content="2017-03-06T13:14:03.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="最佳交易股票时间系列问题（Best Time to Buy and Sell Stock）">
<meta name="twitter:description" content="本篇文章是在实验室算法分享讲座时的内容">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Mist',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 0,
      author: '博主'
    }
  };
</script>

  <title> 最佳交易股票时间系列问题（Best Time to Buy and Sell Stock） | TarsCode </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  



  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?8e0099505ddf5626c155c62af53a2c72";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>








  
  
    
  

  <div class="container one-collumn sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">TarsCode</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle">Make life simple</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-home fa-fw"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-th fa-fw"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-tags fa-fw"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-archive fa-fw"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-read">
          <a href="/read" rel="section">
            
              <i class="menu-item-icon fa fa-th fa-fw"></i> <br />
            
            书单
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-user fa-fw"></i> <br />
            
            关于
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="#" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup">
 <span class="search-icon fa fa-search"></span>
 <input type="text" id="local-search-input">
 <div id="local-search-result"></div>
 <span class="popup-btn-close">close</span>
</div>


    </div>
  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                最佳交易股票时间系列问题（Best Time to Buy and Sell Stock）
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2017-01-15T21:13:23+08:00" content="2017-01-15">
              2017-01-15
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/LeetCode/" itemprop="url" rel="index">
                    <span itemprop="name">LeetCode</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2017/01/15/最佳交易股票时间问题/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2017/01/15/最佳交易股票时间问题/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
              &nbsp; | &nbsp;
              <span class="page-pv"><i class="fa fa-file-o"></i>
              <span class="busuanzi-value" id="busuanzi_value_page_pv" ></span>
              </span>
          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>本篇文章是在实验室算法分享讲座时的内容</p>
<a id="more"></a>
<h4 id="Best-Time-to-Buy-and-Sell-Stock"><a href="#Best-Time-to-Buy-and-Sell-Stock" class="headerlink" title="Best Time to Buy and Sell Stock"></a>Best Time to Buy and Sell Stock</h4><p><strong>题目</strong>：Say you have an array for which the <em>i</em>th element is the price of a given stock on day <em>i</em>.If you were only permitted to complete at most one transaction (ie, buy one and sell one share of the stock), design an algorithm to find the maximum profit.</p>
<p>大意：给定一个整型数组,第i个元素代表第i天股票的价格,如果只允许你最多完成一次交易,即买一个股票然后再卖一次股票,设计一个算法求得交易的最大值。</p>
<p><strong>样例</strong>：</p>
<figure class="highlight"><table><tr><td class="code"><pre><div class="line"><span class="attribute">Input</span>: [7, 1, 5, 3, 6, 4]</div><div class="line"><span class="attribute">Output</span>: 5</div><div class="line"></div><div class="line">max. difference = 6-1 = 5 (not 7-1 = 6, as selling price needs to be larger than buying price)</div></pre></td></tr></table></figure>
<p><strong>分析</strong>：本质上求出有序数组中两个最大的差值，即后面元素减去前面元素的最大值</p>
<h5 id="方法一：暴力法"><a href="#方法一：暴力法" class="headerlink" title="方法一：暴力法"></a>方法一：暴力法</h5><p>思路：遍历数组prices，求出每一个元素prices[i]作为最小值的情况下，获得的收益最大值</p>
<p>举例：</p>
<p>cur表示当前元素作为最小值的情况下，完成一次交易获得收益的最大值</p>
<p>max表示截止到当前元素，完成一次交易获得收益的最大值</p>
<table>
<thead>
<tr>
<th></th>
<th>7</th>
<th>1</th>
<th>5</th>
<th>3</th>
<th>6</th>
<th>4</th>
</tr>
</thead>
<tbody>
<tr>
<td>cur</td>
<td>0</td>
<td>5</td>
<td>1</td>
<td>3</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td>max</td>
<td>0</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>5</td>
</tr>
</tbody>
</table>
<p>复杂度：时间复杂度O(n2),空间复杂度O(1)</p>
<p>代码：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">maxProfit</span><span class="params">(<span class="keyword">int</span>[] prices)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> max = <span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;prices.length;i++)&#123;</div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=i;j&lt;prices.length;j++)&#123;</div><div class="line">                <span class="keyword">int</span> profit = prices[j] - prices[i];</div><div class="line">                max = profit&gt;max?profit:max;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> max;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h5 id="方法二：记录最小值法"><a href="#方法二：记录最小值法" class="headerlink" title="方法二：记录最小值法"></a>方法二：记录最小值法</h5><p>思路：</p>
<p>1、设置一个变量min表示截止到当前元素为止，前i个元素中的最小值，min初始值为Integer.MAX_VALUE；设置变量cur表示当前天数的收益值,初始值为0；设置变量max表示截止当前天数为止，完成一次交易获得收益的最大值。</p>
<p>2、遍历数组prices,将元素prices[i]\&lt;min,则更新min的值</p>
<p>3、若cur>max，则更新max</p>
<p>举例：</p>
<table>
<thead>
<tr>
<th></th>
<th>7</th>
<th>1</th>
<th>5</th>
<th>3</th>
<th>6</th>
<th>4</th>
</tr>
</thead>
<tbody>
<tr>
<td>min</td>
<td>7</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>cur</td>
<td>0</td>
<td>0</td>
<td>4</td>
<td>2</td>
<td>5</td>
<td>3</td>
</tr>
<tr>
<td>max</td>
<td>0</td>
<td>0</td>
<td>4</td>
<td>4</td>
<td>5</td>
<td>5</td>
</tr>
</tbody>
</table>
<p>复杂度：时间复杂度O(n),空间复杂度O(1)</p>
<p>代码：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">maxProfit</span><span class="params">(<span class="keyword">int</span>[] prices)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> max = <span class="number">0</span>;</div><div class="line">        <span class="keyword">int</span> min = Integer.MAX_VALUE;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; prices.length; i++) &#123;</div><div class="line">            min = Math.min(min, prices[i]);</div><div class="line">            max = Math.max(max,prices[i]-min);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> max;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h5 id="方法三：动态规划方法"><a href="#方法三：动态规划方法" class="headerlink" title="方法三：动态规划方法"></a>方法三：动态规划方法</h5><p>思路：</p>
<p>转化为连续子数组的最大和问题</p>
<p>1、设置变量profit表示股票当前价格和前一天价格的差值,初始值为0；设置变量cur表示当天必须参加交易的情况下,获得收益的最大值；设置变量max表示截止当前天数为止，完成一次交易获得收益的最大值。</p>
<table>
<thead>
<tr>
<th></th>
<th>7</th>
<th>1</th>
<th>5</th>
<th>3</th>
<th>6</th>
<th>4</th>
</tr>
</thead>
<tbody>
<tr>
<td>profit</td>
<td>0</td>
<td>-6</td>
<td>4</td>
<td>-2</td>
<td>3</td>
<td>-2</td>
</tr>
<tr>
<td>cur</td>
<td>0</td>
<td>-6</td>
<td>4</td>
<td>2</td>
<td>5</td>
<td>2</td>
</tr>
<tr>
<td>max</td>
<td>0</td>
<td>0</td>
<td>4</td>
<td>4</td>
<td>5</td>
<td>5</td>
</tr>
</tbody>
</table>
<p>复杂度：时间复杂度O(n),空间复杂度O(1)</p>
<p>代码：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">maxProfit</span><span class="params">(<span class="keyword">int</span>[] prices)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> max = <span class="number">0</span>;</div><div class="line">        <span class="keyword">int</span> cur = <span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;prices.length;i++)&#123;</div><div class="line">           cur = Math.max(<span class="number">0</span>,cur+prices[i]-prices[i-<span class="number">1</span>]);</div><div class="line">           max = Math.max(max,cur);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> max;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h4 id="Best-Time-to-Buy-and-Sell-Stock-II"><a href="#Best-Time-to-Buy-and-Sell-Stock-II" class="headerlink" title="Best Time to Buy and Sell Stock II"></a>Best Time to Buy and Sell Stock II</h4><p>题目：Say you have an array for which the <em>i</em>th element is the price of a given stock on day <em>i</em>.Design an algorithm to find the maximum profit. You may complete as many transactions as you like (ie, buy one and sell one share of the stock multiple times). However, you may not engage in multiple transactions at the same time (ie, you must sell the stock before you buy again).</p>
<p>大意：给定一个整型数组,第i个元素代表第i天股票的价格,允许完成多次交易,但是不允许同时拥有多张股票(例如:你在买另一张股票之前必须卖出股票)</p>
<p>样例：</p>
<figure class="highlight avrasm"><table><tr><td class="code"><pre><div class="line"><span class="symbol">Input:</span> [<span class="number">7</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">3</span>, <span class="number">6</span>, <span class="number">4</span>]</div><div class="line"><span class="symbol">Output:</span> <span class="number">7</span></div></pre></td></tr></table></figure>
<p>分析：</p>
<h5 id="方法一：动态规划法"><a href="#方法一：动态规划法" class="headerlink" title="方法一：动态规划法"></a>方法一：动态规划法</h5><p>思路：</p>
<p>下,获得收益的最大值；设置变量max表示截止当前天数为止，完成一次交易获得收益的最大值。</p>
<table>
<thead>
<tr>
<th></th>
<th>7</th>
<th>1</th>
<th>5</th>
<th>3</th>
<th>6</th>
<th>4</th>
</tr>
</thead>
<tbody>
<tr>
<td>profit</td>
<td>0</td>
<td>-6</td>
<td>4</td>
<td>-2</td>
<td>3</td>
<td>-2</td>
</tr>
<tr>
<td>max</td>
<td>0</td>
<td>0</td>
<td>4</td>
<td>4</td>
<td>7</td>
<td>7</td>
</tr>
</tbody>
</table>
<p>复杂度：时间复杂度O(n),空间复杂度O(1)</p>
<p>代码：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">maxProfit</span><span class="params">(<span class="keyword">int</span>[] prices)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> cur = <span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; prices.length; i++) &#123;</div><div class="line">            <span class="keyword">int</span> profit = prices[i] - prices[i - <span class="number">1</span>];</div><div class="line">            cur = profit &gt; <span class="number">0</span> ? cur + profit : cur;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> cur;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h4 id="Best-Time-to-Buy-and-Sell-Stock-III"><a href="#Best-Time-to-Buy-and-Sell-Stock-III" class="headerlink" title="Best Time to Buy and Sell Stock III"></a>Best Time to Buy and Sell Stock III</h4><p>题目：Say you have an array for which the <em>i</em>th element is the price of a given stock on day <em>i</em>.Design an algorithm to find the maximum profit. You may complete at most <em>two</em> transactions.</p>
<p>大意：给定一个整型数组,第i个元素代表第i天股票的价格,设计一个算法找到最大的收益,允许最多进行两次交易。但是不允许同时拥有多张股票(例如:你在买另一张股票之前必须卖出股票)。</p>
<p>样例：</p>
<figure class="highlight avrasm"><table><tr><td class="code"><pre><div class="line"><span class="symbol">Input:</span> [<span class="number">7</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">3</span>, <span class="number">6</span>, <span class="number">4</span>]</div><div class="line"><span class="symbol">Output:</span> <span class="number">7</span></div></pre></td></tr></table></figure>
<p>分析：</p>
<p>1、可以进行一次交易；进行两次交易</p>
<h5 id="方法一：暴力法-1"><a href="#方法一：暴力法-1" class="headerlink" title="方法一：暴力法"></a>方法一：暴力法</h5><p>思路：</p>
<p>复杂度：时间复杂度O(n2),空间复杂度O(1)</p>
<p>代码：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">maxProfit</span><span class="params">(<span class="keyword">int</span>[] prices)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> max = <span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; prices.length; i++) &#123;</div><div class="line">            <span class="keyword">int</span> cur = maxPartProfit(<span class="number">0</span>, i, prices) + maxPartProfit(i, prices.length, prices);</div><div class="line">            max = cur &gt; max ? cur : max;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> max;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">maxPartProfit</span><span class="params">(<span class="keyword">int</span> begin, <span class="keyword">int</span> end, <span class="keyword">int</span>[] prices)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> max = <span class="number">0</span>;</div><div class="line">        <span class="keyword">int</span> profit = <span class="number">0</span>;</div><div class="line">        <span class="keyword">if</span> (prices == <span class="keyword">null</span> || prices.length == <span class="number">0</span>) &#123;</div><div class="line">            <span class="keyword">return</span> max;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">int</span> min = prices[begin];</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = begin; i &lt; end; i++) &#123;</div><div class="line">            <span class="keyword">if</span> (prices[i] &lt;= min) &#123;</div><div class="line">                min = prices[i];</div><div class="line">            &#125; <span class="keyword">else</span> &#123;</div><div class="line">                profit = prices[i] - min;</div><div class="line">                max = profit &gt; max ? profit : max;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> max;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h5 id="方法二：记忆搜索法"><a href="#方法二：记忆搜索法" class="headerlink" title="方法二：记忆搜索法"></a>方法二：记忆搜索法</h5><p>思路：<br>1、设置两个数组left和right，left[i]表示从左至右遍历时前i个元素的最大收益，right[j]表示从右至左遍历时，后i个元素的最大收益。cur变量表示将当前天数分成两次交易时,前i天和后j天收益的最大值，res变量表示当前交易两次的最大值。</p>
<p>2、遍历两次，生成数组left和right</p>
<p>3、</p>
<p>举例：</p>
<table>
<thead>
<tr>
<th></th>
<th>7</th>
<th>1</th>
<th>5</th>
<th>3</th>
<th>6</th>
<th>4</th>
</tr>
</thead>
<tbody>
<tr>
<td>left</td>
<td>0</td>
<td>0</td>
<td>4</td>
<td>4</td>
<td>5</td>
<td>5</td>
</tr>
<tr>
<td>right</td>
<td>5</td>
<td>5</td>
<td>3</td>
<td>3</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td>cur</td>
<td>5</td>
<td>5</td>
<td>7</td>
<td>7</td>
<td>5</td>
<td>5</td>
</tr>
<tr>
<td>res</td>
<td>5</td>
<td>5</td>
<td>7</td>
<td>7</td>
<td>7</td>
<td>7</td>
</tr>
</tbody>
</table>
<p>复杂度：时间复杂度O(n),空间复杂度O(n)</p>
<p>代码：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">maxProfit</span><span class="params">(<span class="keyword">int</span>[] prices)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> cur = <span class="number">0</span>;</div><div class="line">        <span class="keyword">if</span> (prices == <span class="keyword">null</span> || prices.length == <span class="number">0</span>) &#123;</div><div class="line">            <span class="keyword">return</span> cur;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">int</span> len = prices.length;</div><div class="line">        <span class="keyword">int</span> min = prices[<span class="number">0</span>];</div><div class="line">        <span class="keyword">int</span>[] left = <span class="keyword">new</span> <span class="keyword">int</span>[len];</div><div class="line">        left[<span class="number">0</span>] = <span class="number">0</span>;</div><div class="line">        <span class="comment">//从左至右遍历</span></div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; len; i++) &#123;</div><div class="line">            min = prices[i] &lt; min ? prices[i] : min;</div><div class="line">            <span class="keyword">int</span> profit = prices[i] - min;</div><div class="line">            left[i] = profit &gt; left[i - <span class="number">1</span>] ? profit : left[i - <span class="number">1</span>];</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">int</span> max = prices[len - <span class="number">1</span>];</div><div class="line">        <span class="keyword">int</span>[] right = <span class="keyword">new</span> <span class="keyword">int</span>[len];</div><div class="line">        right[len - <span class="number">1</span>] = <span class="number">0</span>;</div><div class="line">        <span class="comment">//从右向左遍历</span></div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = len - <span class="number">2</span>; j &gt;= <span class="number">0</span>; j--) &#123;</div><div class="line">            max = prices[j] &gt; max ? prices[j] : max;</div><div class="line">            <span class="keyword">int</span> profit = max - prices[j];</div><div class="line">            right[j] = profit &gt; right[j + <span class="number">1</span>] ? profit : right[j + <span class="number">1</span>];</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">int</span> res = <span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; len; k++) &#123;</div><div class="line">            cur = left[k] + right[k];</div><div class="line">            res = res &gt; cur ? res : cur;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> res;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h4 id="Best-Time-to-Buy-and-Sell-Stock-IV"><a href="#Best-Time-to-Buy-and-Sell-Stock-IV" class="headerlink" title="Best Time to Buy and Sell Stock IV"></a>Best Time to Buy and Sell Stock IV</h4><p>题目：Say you have an array for which the <em>i</em>th element is the price of a given stock on day <em>i</em>.</p>
<p>Design an algorithm to find the maximum profit. You may complete at most <strong>k</strong> transactions.</p>
<p>大意：给定一个整型数组,第i个元素代表第i天股票的价格,设计一个算法找到最大的收益,允许最多进行k次交易。但是不允许同时拥有多张股票(例如:你在买另一张股票之前必须卖出股票)。</p>
<p>样例：</p>
<figure class="highlight avrasm"><table><tr><td class="code"><pre><div class="line"><span class="symbol">Input:</span> [<span class="number">7</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">3</span>, <span class="number">6</span>, <span class="number">4</span>]</div><div class="line"><span class="symbol">Output:</span> <span class="number">7</span></div></pre></td></tr></table></figure>
<p>分析：求出前k段的最大值</p>
<p>方法一：动态规划</p>
<figure class="highlight java"><table><tr><td class="code"><pre><div class="line">res=Math.max(res[i-<span class="number">1</span>][j],res[i-<span class="number">1</span>][j-<span class="number">1</span>]+profit)</div></pre></td></tr></table></figure>
<p>问题：</p>
<p>1、应该合并交易</p>
<p>举例</p>
<table>
<thead>
<tr>
<th>profit</th>
<th>price</th>
<th>1</th>
<th>2</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td>4</td>
<td>5</td>
<td>4</td>
<td>4</td>
</tr>
<tr>
<td>-3</td>
<td>2</td>
<td>4</td>
<td>4</td>
</tr>
<tr>
<td>2</td>
<td>4</td>
<td>4</td>
<td>6</td>
</tr>
<tr>
<td>3</td>
<td>7</td>
<td>6</td>
<td>7</td>
</tr>
</tbody>
</table>
<p>用local表示到达第i天时，最多进行j次交易的局部最优解；用global表示到达第i天时，最多进行j次的全局最优解。它们二者的关系如下：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><div class="line">local[i][j] = Math.max(global[i – <span class="number">1</span>][j – <span class="number">1</span>] , local[i – <span class="number">1</span>][j] + profit)</div><div class="line">global[i][j] = Math.max(global[i – <span class="number">1</span>][j], local[i][j])</div></pre></td></tr></table></figure>
<p>local表示第i天一定有交易发生</p>
<p>举例</p>
<p>local</p>
<table>
<thead>
<tr>
<th>profit</th>
<th>price</th>
<th>1</th>
<th>2</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td>4</td>
<td>5</td>
<td>4</td>
<td>4</td>
</tr>
<tr>
<td>-3</td>
<td>2</td>
<td>4</td>
<td>4</td>
</tr>
<tr>
<td>2</td>
<td>4</td>
<td>4</td>
<td>6</td>
</tr>
<tr>
<td>3</td>
<td>7</td>
<td>6</td>
<td>9</td>
</tr>
</tbody>
</table>
<p>global</p>
<table>
<thead>
<tr>
<th>profit</th>
<th>price</th>
<th>1</th>
<th>2</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td>4</td>
<td>5</td>
<td>4</td>
<td>4</td>
</tr>
<tr>
<td>-3</td>
<td>2</td>
<td>4</td>
<td>4</td>
</tr>
<tr>
<td>2</td>
<td>4</td>
<td>4</td>
<td>6</td>
</tr>
<tr>
<td>3</td>
<td>7</td>
<td>6</td>
<td>9</td>
</tr>
</tbody>
</table>

      
    </div>
    
    <div>
      
        
<div id="wechat_subscriber" style="display: block； padding: 10px 0; margin: 20px auto; width: 100%; text-align: center">
    <img id="wechat_subscriber_qcode" src="/uploads/wechat-qcode.jpg" alt="Tars wechat" style="width: 200px; max-width: 100%;"/>
    <div>欢迎您扫一扫上面的微信公众号，订阅我的博客！</div>
</div>

      
    </div>

    <div>
      
        
      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/算法/" rel="tag">#算法</a>
          
        </div>
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2017/01/10/深入理解TCP和UDP/" rel="next" title="深入理解TCP和UDP">
                <i class="fa fa-chevron-left"></i> 深入理解TCP和UDP
              </a>
            
          </div>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2017/02/17/Java并发编程一/" rel="prev" title="Java并发编程(一)-并发工具简介">
                Java并发编程(一)-并发工具简介 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
        
<script>
  with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?cdnversion='+~(-new Date()/36e5)];
</script>

      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
      <div class="ds-thread" data-thread-key="2017/01/15/最佳交易股票时间问题/"
           data-title="最佳交易股票时间系列问题（Best Time to Buy and Sell Stock）" data-url="http://yoursite.com/2017/01/15/最佳交易股票时间问题/">
      </div>
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/tars.png"
               alt="Tars" />
          <p class="site-author-name" itemprop="name">Tars</p>
          <p class="site-description motion-element" itemprop="description">Make life simple</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">31</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">11</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">20</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/tarscode" target="_blank">
                  
                    <i class="fa fa-github"></i>
                  
                  github
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://weibo.com/u/2171892561" target="_blank">
                  
                    <i class="fa fa-weibo"></i>
                  
                  weibo
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://www.zhihu.com/people/liu-yang-heuer" target="_blank">
                  
                    <i class="fa fa-globe"></i>
                  
                  知乎
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://www.jianshu.com/users/16e3390681e6" target="_blank">
                  
                    <i class="fa fa-globe"></i>
                  
                  简书
                </a>
              </span>
            
          
        </div>

        
        

        
        <div class="links-of-blogroll motion-element">
          
        </div>

      </section>

      
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">
            
              
            
            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-4"><a class="nav-link" href="#Best-Time-to-Buy-and-Sell-Stock"><span class="nav-number">1.</span> <span class="nav-text">Best Time to Buy and Sell Stock</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#方法一：暴力法"><span class="nav-number">1.1.</span> <span class="nav-text">方法一：暴力法</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#方法二：记录最小值法"><span class="nav-number">1.2.</span> <span class="nav-text">方法二：记录最小值法</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#方法三：动态规划方法"><span class="nav-number">1.3.</span> <span class="nav-text">方法三：动态规划方法</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Best-Time-to-Buy-and-Sell-Stock-II"><span class="nav-number">2.</span> <span class="nav-text">Best Time to Buy and Sell Stock II</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#方法一：动态规划法"><span class="nav-number">2.1.</span> <span class="nav-text">方法一：动态规划法</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Best-Time-to-Buy-and-Sell-Stock-III"><span class="nav-number">3.</span> <span class="nav-text">Best Time to Buy and Sell Stock III</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#方法一：暴力法-1"><span class="nav-number">3.1.</span> <span class="nav-text">方法一：暴力法</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#方法二：记忆搜索法"><span class="nav-number">3.2.</span> <span class="nav-text">方法二：记忆搜索法</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Best-Time-to-Buy-and-Sell-Stock-IV"><span class="nav-number">4.</span> <span class="nav-text">Best Time to Buy and Sell Stock IV</span></a></li></ol></div>
            
          </div>
        </section>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy;  2016 - 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Tars</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="http://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>

        

<div class="busuanzi-count">

  <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv"><i class="fa fa-user"></i><span class="busuanzi-value" id="busuanzi_value_site_uv"></span></span>
  

  
    <span class="site-pv"><i class="fa fa-eye"></i><span class="busuanzi-value" id="busuanzi_value_site_pv"></span></span>
  
  
</div>



        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.0.1"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.0.1"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.0.1"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.1"></script>



  

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"tarscode"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.id = 'duoshuo-script';
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>

  
    
  





  
  
  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length == 0) {
       search_path = "search.xml";
    }
    var path = "/" + search_path;
    // monitor main search box;

    function proceedsearch() {
      $("body").append('<div class="popoverlay">').css('overflow', 'hidden');
      $('.popup').toggle();

    }
    // search function;
    var searchFunc = function(path, search_id, content_id) {
    'use strict';
    $.ajax({
        url: path,
        dataType: "xml",
        async: true,
        success: function( xmlResponse ) {
            // get the contents from search data
            isfetched = true;
            $('.popup').detach().appendTo('.header-inner');
            var datas = $( "entry", xmlResponse ).map(function() {
                return {
                    title: $( "title", this ).text(),
                    content: $("content",this).text(),
                    url: $( "url" , this).text()
                };
            }).get();
            var $input = document.getElementById(search_id);
            var $resultContent = document.getElementById(content_id);
            $input.addEventListener('input', function(){
                var matchcounts = 0;
                var str='<ul class=\"search-result-list\">';                
                var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                $resultContent.innerHTML = "";
                if (this.value.trim().length > 1) {
                // perform local searching
                datas.forEach(function(data) {
                    var isMatch = true;
                    var content_index = [];
                    var data_title = data.title.trim().toLowerCase();
                    var data_content = data.content.trim().replace(/<[^>]+>/g,"").toLowerCase();
                    var data_url = data.url;
                    var index_title = -1;
                    var index_content = -1;
                    var first_occur = -1;
                    // only match artiles with not empty titles and contents
                    if(data_title != '' && data_content != '') {
                        keywords.forEach(function(keyword, i) {
                            index_title = data_title.indexOf(keyword);
                            index_content = data_content.indexOf(keyword);
                            if( index_title < 0 && index_content < 0 ){
                                isMatch = false;
                            } else {
                                if (index_content < 0) {
                                    index_content = 0;
                                }
                                if (i == 0) {
                                    first_occur = index_content;
                                }
                            }
                        });
                    }
                    // show search results
                    if (isMatch) {
                        matchcounts += 1;
                        str += "<li><a href='"+ data_url +"' class='search-result-title'>"+ data_title +"</a>";
                        var content = data.content.trim().replace(/<[^>]+>/g,"");
                        if (first_occur >= 0) {
                            // cut out 100 characters
                            var start = first_occur - 20;
                            var end = first_occur + 80;
                            if(start < 0){
                                start = 0;
                            }
                            if(start == 0){
                                end = 50;
                            }
                            if(end > content.length){
                                end = content.length;
                            }
                            var match_content = content.substring(start, end);
                            // highlight all keywords
                            keywords.forEach(function(keyword){
                                var regS = new RegExp(keyword, "gi");
                                match_content = match_content.replace(regS, "<b class=\"search-keyword\">"+keyword+"</b>");
                            });
                            
                            str += "<p class=\"search-result\">" + match_content +"...</p>"
                        }
                        str += "</li>";
                    }
                })};
                str += "</ul>";
                if (matchcounts == 0) { str = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>' }
                if (keywords == "") { str = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>' }
                $resultContent.innerHTML = str;
            });
            proceedsearch();
        }
    });}

    // handle and trigger popup window;
    $('.popup-trigger').mousedown(function(e) {
      e.stopPropagation();
      if (isfetched == false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };

    });

    $('.popup-btn-close').click(function(e){
      $('.popup').hide();
      $(".popoverlay").remove();
      $('body').css('overflow', '');
    });
    $('.popup').click(function(e){
      e.stopPropagation();
    });
  </script>

  

  

  

</body>
</html>
